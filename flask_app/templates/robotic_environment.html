{% extends "base.html" %}

{% block title %}
<title>Robotic Environment</title>
{% endblock %}

{% block body %}
<section>
    <div class="container-fluid">
        <div class="row d-flex">
            <!-- Code editor on the left -->
            <div class="col-md-6" style="margin-top: 200px;">
                <div class="code-editor">
                    <h4>Python Code Editor</h4>
                    <!-- CodeMirror Text Area -->
                    <textarea id="code-editor" rows="20" placeholder="# Your code here!"></textarea>
                </div>
            </div>

            <!-- Video player on the right -->
            <div class="col-md-6 d-flex justify-content-center align-items-center" style="margin-top: 200px;">
                <div class="video-container">
                    <img src="{{ url_for('video_feed') }}" width="100%">
                </div>
            </div>
        </div>

        <!-- File upload and Run button at the bottom -->
        <div class="row mt-4">
            <div class="col-md-6">
                <input type="file" id="file-upload" class="form-control">
            </div>
            <div class="col-md-6 text-right">
                <button id="run-code" class="btn btn-success">Run</button>
            </div>
        </div>
    </div>
</section>

<script>
    document.getElementById('run-code').addEventListener('click', function() {
        const code = document.getElementById('code-editor').value;

        const formData = new FormData();
        formData.append('code', code);

        fetch('/run-code', {
            method: 'POST',
            body: formData,
        })
        .then(response => response.json())
        .then(data => {
            console.log(data);
        });
    });
</script>

{% endblock %}
